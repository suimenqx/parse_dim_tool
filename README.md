# 离线表格分析器（Smart Parser）· v17.0

> 单页、纯前端的表格解析 / 过滤 / 联表工具，零依赖、开箱即用，适合在没有后台或外网的环境快速排查和导出数据。

## 功能特性
- 纯前端离线运行：仅需双击 `index.html` 即可使用，无需安装、无后端依赖。
- 多格式解析：根据输入自动识别制表符、逗号、空格/定宽表头等格式，将文本快速拆解为多张表。
- 多标签页会话：支持在一个浏览器里同时保存多份数据源与配置，状态持久化到 localStorage。
- 预览与交互：表格可折叠、列宽自适应，长文本悬停可看全量；可拖拽选择单元格并复制为 TSV/HTML。
- 过滤与高亮：全局过滤 + 表级过滤 + 高亮规则，支持比较/包含/正则/OR 语法，可切换“仅显示高亮行”。
- 列筛选与聚焦：点击表头即可按列过滤；可选择“关注列 / 显示列”让预览与导出只保留关键列。
- JOIN 视图：内置 Join Designer，支持配置 inner/left join、字段映射、输出列顺序与别名，可递归引用其他视图。
- 导出与备份：一键导出原始表或当前预览为 Excel，并可导入/导出页签与配置 JSON 做备份或迁移。
- 主题与快捷操作：亮/暗主题切换；Join 设计器支持键盘快捷键，预览支持双击编辑。

## 快速开始
1) 下载或克隆仓库，直接在浏览器打开 `index.html`（无需本地服务器）。  
2) 在左侧“数据源”粘贴表格文本，或点击 ⭐ 载入示例数据。  
3) 点击“解析”，右侧会生成各张表的预览卡片。  
4) 在“配置规则”里设定目标表、高亮规则、行过滤、全局过滤，或选择关注列。  
5) 需要联表时点击“管理”进入 Join Designer，配置完成后在“启用 JOIN 视图”中勾选即可预览。  
6) 通过顶部“导出预览 Excel”或侧栏“导出原始”导出结果；导出/导入页签或配置以便备份。  

## 数据格式
- 每张表以 `table-data <表名>` 起始，下一行必须以 `validflag` 开头作为表头。  
- 表头行可为制表符、逗号、空格分隔或定宽格式（自动推断列范围）。  
- 数据行按表头列数解析，遇到空行或以 `<` / `[` 开头的行结束当前表。  
- 同一输入可包含多张表，表名及列名大小写按原样保留。  
- 示例（左侧示例按钮会自动填充）：  
   ```text
   table-data Inventory
   validflag ID      Product       Category    Stock   Price
    1        1001    Widget_A      Hardware    50      10.50
    1        1002    Widget_B      Hardware    0       25.00

   table-data Orders
   validflag OrderID CustID  ProdID  Qty   Status
    1        5001    C001    1001    5     Shipped
   ```

## 过滤与高亮规则
- **作用范围**：  
  - `全局过滤` 作用于所有表。  
  - `行过滤` / `高亮规则` 作用于当前“配置目标表”。  
  - 可选“仅显示高亮行”。  
- **语法（不区分大小写，空格代表 AND，`|` 代表 OR）**：  
  - 精确/包含：`key=value`、`key!=value`、`Msg:Error`  
  - 数值比较：`CPU>90`、`Score<=60`  
  - 正则：`/timeout|error/`  
- **列过滤**：点击表头弹出输入框，按列进行包含过滤；有蓝点表示已过滤，`×` 可单列清除，表头元信息里的“列过滤”标签可一键清空。  
- **列聚焦**：在“关注列 / 显示列”输入列名或点击“选择”勾选列，只展示并导出所选列，便于比对。  

## JOIN 视图设计器
- 在“管理”打开 Join Designer，可新增 / 编辑 / 复制 / 删除全局视图，配置保存在 localStorage。  
- 设置视图名、左表/右表、Join 类型（Inner/Left），在 “ON” 区域添加匹配字段，支持自动匹配与左右互换。  
- 左右两侧列表可搜索字段、仅看已选；中间的输出区支持拖拽调整顺序、填写别名、过滤左右列显示。  
- 保存后在“启用 JOIN 视图”中勾选即可与原始表一起预览；视图可引用其他视图（自动阻止循环依赖）。  
- 管理弹窗里的“粘贴配置 (JSON)”支持从导出的视图配置文本快速导入。  

## 导出与备份
- **导出原始**：将解析出的原始表批量导出为 Excel。  
- **导出预览 Excel**：导出当前预览（包含过滤、高亮、聚焦列、JOIN 结果）为 Excel。  
- **导出/导入页签**：备份或迁移所有标签页的原始数据与 UI 状态（文件含 `kind: table-tool-tabs`）。  
- **导出/导入配置**：仅同步配置（全局视图 + 各标签的规则，不覆盖原始粘贴的数据，文件含 `kind: table-tool-config`）。  
- 所有导出均在浏览器本地完成，无网络请求。  

## 操作技巧
- 表格区拖动选择单元格，`Ctrl+C` / `⌘+C` 复制同时生成 TSV 与 HTML（包含表头）。  
- 双击单元格可内联编辑预览数据（立即影响预览和导出，但不会改写左侧原始输入）。  
- 双击表卡片头部可折叠/展开；长文本悬停可查看完整内容。  
- 主题按钮可在亮/暗模式间切换并记忆；顶部 `＋` 可新建标签页。  
- Join Designer 快捷键：`Enter` 保存、`Esc` 关闭、`/` 聚焦搜索框。  

## 数据存储与注意事项
- 标签页、规则、主题、视图等状态存储在浏览器 localStorage 中。清理缓存或更换浏览器前请先导出页签或配置做备份。  
- 工具完全离线运行；若需分享结果，推荐导出预览 Excel 或导出 JSON 配置。  

## 目录
- `index.html`：单页应用，包含全部逻辑与样式。  
- `README.md`：项目介绍与使用指南。  
